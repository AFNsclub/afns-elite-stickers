<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
:root{
  --bg:#050b1e;
  --card:#0b1622;
  --accent:#4f8cff;
  --text:#ffffff;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Arial,sans-serif;
  background:radial-gradient(circle at top,#0a1a4a,#050b1e);
  color:var(--text);
}
.header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:14px 16px;
  background:linear-gradient(180deg,#070f2a,#050b1e);
}
.brand{display:flex;align-items:center;gap:10px}
.brand img{height:36px}
.role{
  font-size:12px;
  color:#ffd400;
  margin-left:8px;
}
.logout{
  background:none;
  border:1px solid var(--accent);
  color:var(--accent);
  padding:6px 14px;
  border-radius:8px;
  cursor:pointer;
}
.container{max-width:1100px;margin:auto;padding:18px}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
  gap:16px;
}
.card{
  background:#0b1622;
  border-radius:18px;
  padding:20px;
  cursor:pointer;
  transition:.25s;
}
.card:hover{
  transform:translateY(-4px);
  box-shadow:0 0 18px rgba(79,140,255,.4);
}
.icon{font-size:28px}
.title{margin-top:10px;font-weight:bold}
.desc{font-size:12px;opacity:.6}

.stats,.alerts,.quick{
  margin-top:22px;
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
  gap:14px;
}
.stat,.alert,.quick button{
  background:rgba(255,255,255,.05);
  border-radius:16px;
  padding:16px;
  text-align:center;
}
.stat span{
  display:block;
  font-size:24px;
  font-weight:bold;
  color:var(--accent);
}
.quick button{
  background:#0b1622;
  border:1px solid var(--accent);
  color:var(--accent);
  cursor:pointer;
}
.footer{text-align:center;font-size:12px;opacity:.5;margin-top:30px}
</style>
</head>

<body>

<div class="header">
  <div class="brand">
    <img src="logo.png">
    <span>Admin Dashboard</span>
    <span class="role" id="adminRole">Loading...</span>
  </div>
  <button class="logout" onclick="logout()">Logout</button>
</div>

<div class="container">

<!-- MAIN GRID -->
<div class="grid" id="mainGrid">

  <div class="card" onclick="go('tournament.html')">
    <div class="icon">ğŸ†</div>
    <div class="title">Tournament Builder</div>
    <div class="desc">Create & manage tournaments</div>
  </div>

  <div class="card" onclick="go('pvp-result.html')">
    <div class="icon">âš”ï¸</div>
    <div class="title">PvP Match</div>
    <div class="desc">Player vs Player result</div>
  </div>

  <div class="card" onclick="go('admin-match-control.html')">
    <div class="icon">ğŸ› </div>
    <div class="title">Match Control</div>
    <div class="desc">Edit / rollback / review</div>
  </div>

  <div class="card" onclick="go('admin-player.html')">
    <div class="icon">ğŸ‘¤</div>
    <div class="title">Player Inspector</div>
    <div class="desc">View full player profile</div>
  </div>

  <div class="card" onclick="go('ranking.html')">
    <div class="icon">ğŸ“Š</div>
    <div class="title">Ranking Board</div>
    <div class="desc">Season based rankings</div>
  </div>

  <div class="card" onclick="go('admin-season-reset.html')">
    <div class="icon">â™»ï¸</div>
    <div class="title">Season Manager</div>
    <div class="desc">3x reset per year</div>
  </div>

  <div class="card" onclick="go('champion.html')">
    <div class="icon">ğŸ‘‘</div>
    <div class="title">Champion</div>
    <div class="desc">Profile & certificate</div>
  </div>

  <div class="card" onclick="go('activity.html')">
    <div class="icon">ğŸ§¾</div>
    <div class="title">Activity Log</div>
    <div class="desc">System actions</div>
  </div>

  <!-- ğŸ” ROLE MANAGER (OWNER ONLY) -->
  <div class="card" id="roleManagerCard" style="display:none"
       onclick="go('admin-role-manager.html')">
    <div class="icon">ğŸ›¡ï¸</div>
    <div class="title">Role Manager</div>
    <div class="desc">Admin / Captain / Manager control</div>
  </div>

</div>

<!-- STATS -->
<div class="stats">
  <div class="stat"><span id="players">0</span>Players</div>
  <div class="stat"><span id="matches">0</span>Matches</div>
  <div class="stat"><span id="tournaments">0</span>Tournaments</div>
  <div class="stat"><span>OK</span>System</div>
</div>

<div class="footer">
  AFNS Club â€¢ Premium Admin System
</div>

</div>

<script>
/* ğŸ”¥ FIREBASE INIT */
firebase.initializeApp({
  apiKey:"AIzaSyBtDxu0LJyb10ZkhH8IpxT5s8PcKc4nUxM",
  authDomain:"afnsclub.firebaseapp.com",
  projectId:"afnsclub"
});

const auth=firebase.auth();
const db=firebase.firestore();

/* ğŸ” AUTH + ROLE */
auth.onAuthStateChanged(async user=>{
  if(!user) location.href="admin-login.html";

  const snap = await db.collection("admins").doc(user.uid).get();
  if(!snap.exists){
    alert("Access denied");
    location.href="admin-login.html";
    return;
  }

  const data = snap.data();
  const role = data.role || "admin";
  const badge = data.badge || "ğŸ‘‘";

  adminRole.innerText = badge+" "+role.toUpperCase();

  // OWNER only
  if(role === "owner"){
    roleManagerCard.style.display="block";
  }
});

/* ğŸ“Š LIVE STATS */
db.collection("players").onSnapshot(s=>players.innerText=s.size);
db.collection("matches").onSnapshot(s=>matches.innerText=s.size);
db.collection("tournaments").onSnapshot(s=>tournaments.innerText=s.size);

function go(p){location.href=p}
function logout(){
  auth.signOut().then(()=>location.href="admin-login.html");
}
</script>

</body>
</html>
