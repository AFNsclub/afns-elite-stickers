    <div class="icon">â™»ï¸</div>
    <div class="title">Season Manager</div>
    <div class="desc">Reset season</div>
  </div>

  <div class="card perm-manageRoles" onclick="go('admin-role-manager.html')">
    <div class="icon">ğŸ›¡ï¸</div>
    <div class="title">Role Manager</div>
    <div class="desc">Permissions & roles</div>
  </div>

</div>

<!-- PERMISSIONS -->
<div class="section-title">ğŸ›¡ï¸ My Permissions</div>
<div class="permissions">
  <div class="box" id="permBox"></div>
</div>

<!-- STATS -->
<div class="stats">
  <div class="stat"><span id="players">0</span>Players</div>
  <div class="stat"><span id="matches">0</span>Matches</div>
  <div class="stat"><span id="admins">0</span>Admins</div>
  <div class="stat"><span>OK</span>System</div>
</div>

<div class="footer">
  AFNS Club â€¢ Pro Admin System
</div>

</div>

<script>
/* ğŸ”¥ FIREBASE INIT */
firebase.initializeApp({
  apiKey:"AIzaSyBtDxu0LJyb10ZkhH8IpxT5s8PcKc4nUxM",
  authDomain:"afnsclub.firebaseapp.com",
  projectId:"afnsclub"
});

const auth = firebase.auth();
const db   = firebase.firestore();

/* ğŸ” AUTH GUARD (FINAL) */
auth.onAuthStateChanged(async user=>{
  if(!user){
    location.href="admin-login.html";
    return;
  }

  try{
    const snap = await db.collection("admins").doc(user.email).get();
    if(!snap.exists) throw "no-admin";

    const a = snap.data();

    if(a.active !== true) throw "inactive";
    if(a.uid && a.uid !== user.uid) throw "uid-mismatch";

    adminRole.innerText = (a.badge||"") + " " + a.role.toUpperCase();

    document.querySelectorAll("[class*='perm-']").forEach(el=>{
      const m = el.className.match(/perm-(\w+)/);
      if(m && a.permission && a.permission[m[1]] !== true){
        el.style.display="none";
      }
    });

    let html="";
    if(a.permission){
      for(const k in a.permission){
        html+=`${a.permission[k]?"âœ”":"âŒ"} ${k}<br>`;
      }
    }
    permBox.innerHTML = html || "No permissions";

  }catch(e){
    alert("Access denied");
    await auth.signOut();
    location.href="admin-login.html";
  }
});

/* ğŸ“Š STATS */
db.collection("players").onSnapshot(s=>players.innerText=s.size);
db.collection("matches").onSnapshot(s=>matches.innerText=s.size);
db.collection("admins").onSnapshot(s=>admins.innerText=s.size);

function go(p){location.href=p}
function logout(){
  auth.signOut().then(()=>location.href="admin-login.html");
}
</script>

</body>
                                </html>
