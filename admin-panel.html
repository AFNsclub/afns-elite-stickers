<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{
  background:#0d1117;
  color:#fff;
  font-family:Arial;
  margin:0;
}
.container{
  max-width:480px;
  margin:auto;
  padding:15px;
}
h2{text-align:center;color:#22c55e;}
.card{
  background:#161b22;
  padding:15px;
  border-radius:12px;
  margin-bottom:12px;
}
input{
  width:100%;
  padding:8px;
  margin:5px 0;
  border-radius:8px;
  border:none;
}
button{
  width:100%;
  padding:10px;
  background:#22c55e;
  color:#000;
  border:none;
  border-radius:10px;
  font-weight:bold;
}
</style>
</head>
<body>

<div class="container">
<h2>Admin Panel</h2>
<div id="players"></div>
</div>

<script type="module">
import { db, auth } from "./firebase-init.js";
import { collection, getDocs, updateDoc, doc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

onAuthStateChanged(auth,user=>{
  if(!user){
    location.href="admin-login.html";
  }
});

const snap = await getDocs(collection(db,"players"));
const wrap = document.getElementById("players");

snap.forEach(d=>{
  const p=d.data();
  const div=document.createElement("div");
  div.className="card";
  div.innerHTML=`
    <b>${p.name}</b><br><br>
    Goals For <input id="gf-${d.id}" value="${p.goalsFor||0}">
    Goals Against <input id="ga-${d.id}" value="${p.goalsAgainst||0}">
    Win <input id="w-${d.id}" value="${p.win||0}">
    Lose <input id="l-${d.id}" value="${p.lose||0}">
    <button onclick="update('${d.id}')">Update</button>
  `;
  wrap.appendChild(div);
});

window.update=async(id)=>{
  await updateDoc(doc(db,"players",id),{
    goalsFor:+document.getElementById("gf-"+id).value,
    goalsAgainst:+document.getElementById("ga-"+id).value,
    win:+document.getElementById("w-"+id).value,
    lose:+document.getElementById("l-"+id).value
  });
  alert("Updated");
}
</script>
</body>
</html>
