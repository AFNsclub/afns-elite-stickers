<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Login</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box;font-family:Arial,Helvetica,sans-serif}
body{
  margin:0;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  background:linear-gradient(135deg,#050b1f,#0a1233);
  color:#fff;
}
.box{
  width:360px;
  background:rgba(255,255,255,.06);
  backdrop-filter:blur(10px);
  padding:26px;
  border-radius:16px;
  box-shadow:0 0 25px rgba(0,0,0,.6);
}
.logo{text-align:center;margin-bottom:16px}
.logo img{
  height:60px;
  filter:drop-shadow(0 0 10px rgba(79,140,255,.6));
}
h2{text-align:center;margin:10px 0 18px}
input{
  width:100%;
  padding:12px;
  margin-top:12px;
  border:none;
  border-radius:8px;
  outline:none;
}
.pass-wrap{position:relative}
.pass-wrap span{
  position:absolute;
  right:12px;
  top:50%;
  transform:translateY(-50%);
  cursor:pointer;
  font-size:13px;
  opacity:.7;
}
button{
  width:100%;
  margin-top:16px;
  padding:12px;
  border:none;
  border-radius:10px;
  background:#4f8cff;
  color:#fff;
  font-weight:bold;
  cursor:pointer;
}
button:hover{box-shadow:0 0 14px rgba(79,140,255,.7)}
.msg{margin-top:14px;text-align:center;font-size:14px}
.error{color:#ff6b6b}
.success{color:#22c55e}
.forgot{
  margin-top:14px;
  text-align:center;
  font-size:13px;
  opacity:.8;
  cursor:pointer;
}
.forgot:hover{text-decoration:underline}
footer{
  margin-top:20px;
  text-align:center;
  font-size:12px;
  opacity:.5;
}
</style>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey:"AIzaSyBtDxu0LJyb10ZkhH8IpxT5s8PcKc4nUxM",
  authDomain:"afnsclub.firebaseapp.com",
  projectId:"afnsclub"
});

/* ðŸ”¥ KEEP LOGIN */
firebase.auth().setPersistence(
  firebase.auth.Auth.Persistence.LOCAL
);
</script>
</head>

<body>

<div class="box">
  <div class="logo">
    <img src="logo.png">
  </div>

  <h2>Admin Login</h2>

  <input type="email" id="email" placeholder="Admin Email">

  <div class="pass-wrap">
    <input type="password" id="password" placeholder="Password">
    <span id="toggleBtn" onclick="togglePass()">SHOW</span>
  </div>

  <button onclick="login()">LOGIN</button>

  <div class="msg" id="msg"></div>

  <div class="forgot" onclick="forgot()">Forgot password?</div>

  <footer>
    AFNs Elite Striker |
    <a href="https://www.facebook.com/share/1CTCywTQAj/" target="_blank">
      SI Shohan
    </a>
  </footer>
</div>

<script>
const auth = firebase.auth();
const db   = firebase.firestore();
const msg  = document.getElementById("msg");
const OWNER_EMAIL = "sisaif167@gmail.com";

/* ðŸ‘ PASSWORD TOGGLE */
function togglePass(){
  const p=document.getElementById("password");
  const btn=document.getElementById("toggleBtn");

  if(p.type==="password"){
    p.type="text";
    btn.textContent="HIDE";
  }else{
    p.type="password";
    btn.textContent="SHOW";
  }
}

/* ðŸ” ADMIN LOGIN WITH ROLE CHECK */
function login(){
  const email=document.getElementById("email").value.trim();
  const pass=document.getElementById("password").value;

  msg.textContent="";
  msg.className="msg";

  if(!email || !pass){
    msg.textContent="Email & Password required";
    msg.classList.add("error");
    return;
  }

  auth.signInWithEmailAndPassword(email,pass)
    .then(async (cred)=>{

      // OWNER always allowed
      if(email === OWNER_EMAIL){
        location.href="admin.html";
        return;
      }

      // Firestore admin check
      const adminDoc = await db.collection("admins").doc(email).get();

      if(!adminDoc.exists || adminDoc.data().active !== true){
        await auth.signOut();
        msg.textContent="Access Denied";
        msg.classList.add("error");
        return;
      }

      msg.textContent="Login success âœ“";
      msg.classList.add("success");
      setTimeout(()=>location.href="admin.html",800);
    })
    .catch(err=>{
      msg.textContent=err.message;
      msg.classList.add("error");
    });
}

/* ðŸ” FORGOT PASSWORD */
function forgot(){
  const email=document.getElementById("email").value.trim();
  if(!email) return alert("Enter email first");

  auth.sendPasswordResetEmail(email)
    .then(()=>alert("Password reset email sent"))
    .catch(e=>alert(e.message));
}
</script>

</body>
</html>
