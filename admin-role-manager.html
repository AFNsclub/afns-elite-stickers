<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Role Manager</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{
  background:#050b1e;
  color:#fff;
  font-family:Arial;
  padding:20px;
}
.box{
  max-width:500px;
  margin:auto;
  background:#0b1622;
  padding:20px;
  border-radius:14px;
}
select,input,label{
  width:100%;
  margin:8px 0;
}
button{
  width:100%;
  padding:10px;
  background:#4f8cff;
  border:none;
  border-radius:8px;
  color:#fff;
  cursor:pointer;
}
.permissions label{
  display:flex;
  justify-content:space-between;
}
</style>
</head>

<body>

<div class="box">
  <h2>üõ°Ô∏è Role Manager</h2>

  <select id="playerSelect"></select>

  <select id="role">
    <option value="admin">Admin</option>
    <option value="captain">Captain</option>
    <option value="vice-captain">Vice Captain</option>
    <option value="manager">Manager</option>
  </select>

  <input id="team" placeholder="Team / Responsibility">
  <input id="badge" placeholder="Emoji Badge (üëë ‚≠ê ‚öîÔ∏è)">

  <div class="permissions">
    <label>Add Match <input type="checkbox" id="addMatch"></label>
    <label>Edit Match <input type="checkbox" id="editMatch"></label>
    <label>Delete Match <input type="checkbox" id="deleteMatch"></label>
  </div>

  <button onclick="saveRole()">Save Role</button>
</div>

<script>
firebase.initializeApp({
  apiKey:"AIzaSyBtDxu0LJyb10ZkhH8IpxT5s8PcKc4nUxM",
  authDomain:"afnsclub.firebaseapp.com",
  projectId:"afnsclub"
});

const db=firebase.firestore();
const auth=firebase.auth();

auth.onAuthStateChanged(async u=>{
  if(!u) location.href="admin-login.html";
  const a=await db.collection("admins").doc(u.uid).get();
  if(a.data().role!=="owner") location.href="admin.html";
  loadPlayers();
});

function loadPlayers(){
  db.collection("players").get().then(s=>{
    s.forEach(d=>{
      playerSelect.innerHTML+=`<option value="${d.id}">${d.data().name}</option>`;
    });
  });
}

function saveRole(){
  const pid=playerSelect.value;
  db.collection("admins").doc(pid).set({
    role: role.value,
    team: team.value,
    badge: badge.value,
    permissions:{
      addMatch:addMatch.checked,
      editMatch:editMatch.checked,
      deleteMatch:deleteMatch.checked
    }
  });
  alert("Role Updated ‚úÖ");
}
</script>

</body>
</html>
