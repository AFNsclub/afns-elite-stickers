<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AFNS Leaderboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{
  margin:0;
  background:#050b1e;
  color:#fff;
  font-family:Arial;
}
.container{
  max-width:1000px;
  margin:auto;
  padding:16px;
}
h2{text-align:center;}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:15px;
}
th,td{
  padding:10px;
  text-align:center;
}
th{
  background:#111c30;
}
tr:nth-child(even){
  background:#0d1728;
}
.rank{
  font-weight:bold;
  color:#00ff99;
}
</style>
</head>

<body>

<div class="container">
<h2>üèÜ AFNS Elite Strikers Ranking</h2>
<table>
<thead>
<tr>
<th>Rank</th>
<th>Player</th>
<th>Win</th>
<th>Loss</th>
<th>Draw</th>
<th>Rating</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>
</div>

<script>

firebase.initializeApp({
  apiKey:"AIzaSyBtDxu0LJyb10ZkhH8IpxT5s8PcKc4nUxM",
  authDomain:"afnsclub.firebaseapp.com",
  projectId:"afnsclub"
});

const db = firebase.firestore();
const tbody = document.getElementById("tbody");

db.collection("players").onSnapshot(async snap=>{

  let players=[];

  snap.forEach(doc=>{
    const d=doc.data();
    players.push({
      id:doc.id,
      username:d.username || "Unknown",
      win:d.win || 0,
      loss:d.loss || 0,
      draw:d.draw || 0,
      rating:d.rating || 1000
    });
  });

  // Sort by rating
  players.sort((a,b)=>b.rating - a.rating);

  tbody.innerHTML="";

  for(let i=0;i<players.length;i++){

    const p=players[i];
    const rank=i+1;

    // üî• ranking auto update
    await db.collection("players").doc(p.id).update({
      ranking:rank
    });

    const tr=document.createElement("tr");
    tr.innerHTML=`
      <td class="rank">#${rank}</td>
      <td>${p.username}</td>
      <td>${p.win}</td>
      <td>${p.loss}</td>
      <td>${p.draw}</td>
      <td>${p.rating}</td>
    `;
    tbody.appendChild(tr);
  }

});

</script>

</body>
</html>
