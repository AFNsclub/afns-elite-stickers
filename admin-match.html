<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Match Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family:Arial;
  background:#0b1d3a;
  color:white;
}
header{
  background:#111;
  padding:15px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
button{
  padding:8px 14px;
  border:none;
  border-radius:6px;
  cursor:pointer;
  font-weight:bold;
}
.logout{
  background:#ff4d4d;
  color:white;
}
.approve{
  background:#4CAF50;
  color:white;
}
.reject{
  background:#ff9800;
  color:black;
}
.container{
  padding:15px;
}
.card{
  background:#111;
  border-radius:10px;
  padding:15px;
  margin-bottom:15px;
}
.small{
  opacity:.8;
  font-size:14px;
}
</style>
</head>

<body>

<!-- ðŸ” ADMIN SECURITY CHECK -->
<script>
if(localStorage.getItem("adminLoggedIn")!=="true"){
  alert("Admin access only!");
  location.href="admin-login.html";
}
</script>

<header>
  <h2>Admin Match Approval</h2>
  <button class="logout" onclick="logout()">Logout</button>
</header>

<div class="container" id="matchList">
  <!-- Matches will load here -->
</div>

<script>
// ðŸ” LOGOUT
function logout(){
  localStorage.removeItem("adminLoggedIn");
  location.href="admin-login.html";
}

// Load matches
let matches = JSON.parse(localStorage.getItem("matches")) || [];
let players = JSON.parse(localStorage.getItem("players")) || [];
const box = document.getElementById("matchList");

function saveAll(){
  localStorage.setItem("matches", JSON.stringify(matches));
  localStorage.setItem("players", JSON.stringify(players));
}

function approveMatch(i){
  if(matches[i].status!=="pending") return;

  matches[i].status="approved";

  let winner = players.find(p=>p.username===matches[i].winner);
  let loser  = players.find(p=>p.username===matches[i].loser);

  if(winner){
    winner.rating = (winner.rating || 1000) + 25;
  }
  if(loser){
    loser.rating = (loser.rating || 1000) - 15;
  }

  saveAll();
  load();
}

function rejectMatch(i){
  matches[i].status="rejected";
  saveAll();
  load();
}

function load(){
  box.innerHTML="";
  if(matches.length===0){
    box.innerHTML="<p>No matches submitted</p>";
    return;
  }

  matches.forEach((m,i)=>{
    box.innerHTML+=`
      <div class="card">
        <h3>${m.winner} ðŸ†š ${m.loser}</h3>
        <p class="small">Result: ${m.score}</p>
        <p class="small">Status: <b>${m.status}</b></p>

        ${m.status==="pending" ? `
          <button class="approve" onclick="approveMatch(${i})">Approve</button>
          <button class="reject" onclick="rejectMatch(${i})">Reject</button>
        ` : ""}
      </div>
    `;
  });
}

load();
</script>

</body>
</html>
