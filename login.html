<script src="firebase.js"></script>
<script>
auth.onAuthStateChanged(user=>{
  if(!user) return;

  db.collection("players").doc(user.uid).get().then(doc=>{
    const d = doc.data();

    if(d.banned){
      if(d.banUntil && Date.now() > d.banUntil){
        db.collection("players").doc(user.uid).update({
          banned:false,
          banUntil:null
        }).then(()=>location.href="player.html");
      }else{
        const days = Math.ceil((d.banUntil-Date.now())/86400000);
        alert("You are banned for "+days+" day(s)");
        auth.signOut();
      }
    }else{
      location.href="player.html";
    }
  });
});
</script>
