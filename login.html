<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Player Login</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box;font-family:Arial,Helvetica,sans-serif}
body{
  margin:0;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  background:linear-gradient(135deg,#050b1f,#0a1233);
  color:#fff;
}
.box{
  width:380px;
  background:rgba(255,255,255,.06);
  backdrop-filter:blur(10px);
  padding:26px;
  border-radius:16px;
  box-shadow:0 0 25px rgba(0,0,0,.6);
}
.logo{
  text-align:center;
  margin-bottom:8px;
}
.logo img{
  height:60px;
}
h2{
  text-align:center;
  margin:10px 0 16px;
}
input{
  width:100%;
  padding:11px;
  margin-top:10px;
  border:none;
  border-radius:8px;
  outline:none;
}
.pass-wrap{
  position:relative;
}
.pass-wrap span{
  position:absolute;
  right:12px;
  top:50%;
  transform:translateY(-50%);
  font-size:12px;
  cursor:pointer;
  opacity:.7;
}
button{
  width:100%;
  margin-top:16px;
  padding:12px;
  border:none;
  border-radius:10px;
  background:#3b82f6;
  color:#fff;
  font-weight:bold;
  cursor:pointer;
}
button:hover{
  box-shadow:0 0 14px rgba(59,130,246,.7);
}
.links{
  margin-top:12px;
  display:flex;
  justify-content:space-between;
  font-size:13px;
}
.links a{
  color:#a5b4fc;
  text-decoration:none;
}
.links a:hover{text-decoration:underline}
.msg{
  margin-top:14px;
  text-align:center;
  font-size:14px;
}
.error{color:#ff6b6b}
.success{color:#22c55e}
footer{
  margin-top:18px;
  text-align:center;
  font-size:12px;
  opacity:.5;
}
</style>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey:"AIzaSyBtDxu0LJyb10ZkhH8IpxT5s8PcKc4nUxM",
  authDomain:"afnsclub.firebaseapp.com",
  projectId:"afnsclub"
});
</script>
</head>

<body>

<div class="box">
  <div class="logo">
    <img src="logo.png">
  </div>

  <h2>Player Login</h2>

  <input id="email" placeholder="Email">

  <div class="pass-wrap">
    <input type="password" id="password" placeholder="Password">
    <span onclick="togglePass()">SHOW</span>
  </div>

  <button onclick="login()">LOGIN</button>

  <div class="links">
    <a href="#" onclick="forgot()">Forgot Password?</a>
    <a href="register.html">Create Account</a>
  </div>

  <div class="msg" id="msg"></div>

  <footer>
    AFNs Elite Striker |
    <a href="https://www.facebook.com/share/1CTCywTQAj/" target="_blank">
      SI Shohan
    </a>
  </footer>
</div>

<script>
const auth=firebase.auth();
const db=firebase.firestore();
const msg=document.getElementById("msg");

function togglePass(){
  const p=document.getElementById("password");
  p.type=p.type==="password"?"text":"password";
}

function login(){
  const email=document.getElementById("email").value.trim();
  const pass=document.getElementById("password").value;

  msg.textContent="";
  msg.className="msg";

  if(!email||!pass){
    msg.textContent="Email & password required";
    msg.classList.add("error");
    return;
  }

  auth.signInWithEmailAndPassword(email,pass)
    .then(res=>{
      const uid=res.user.uid;

      db.collection("players").doc(uid).get().then(doc=>{
        if(!doc.exists){
          msg.textContent="Player profile not found";
          msg.classList.add("error");
          auth.signOut();
          return;
        }

        const d=doc.data();

        if(d.banned){
          const until=d.banUntil?.toDate();
          msg.textContent=until
            ? "You are banned until "+until.toLocaleDateString()
            : "You are permanently banned";
          msg.classList.add("error");
          auth.signOut();
          return;
        }

        window.__UID__=uid;
        msg.textContent="Login successful ✓";
        msg.classList.add("success");

        setTimeout(()=>{
          location.href="player.html";
        },700);
      });
    })
    .catch(err=>{
      msg.textContent=err.message;
      msg.classList.add("error");
    });
}

function forgot(){
  const email=document.getElementById("email").value.trim();
  if(!email){
    msg.textContent="Enter email first";
    msg.classList.add("error");
    return;
  }

  auth.sendPasswordResetEmail(email)
    .then(()=>{
      msg.textContent="Password reset email sent ✓";
      msg.classList.add("success");
    })
    .catch(err=>{
      msg.textContent=err.message;
      msg.classList.add("error");
    });
}
</script>

</body>
</html>
